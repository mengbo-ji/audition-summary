## 概念

微前端作为一个类似微服务的架构，它其实就是把微服务这样的理念应用到了浏览器端，我们把单体的一个前端 web 应用也去按功能维度进行拆分，然后再聚合到一个整体的应用架构下面，这边是微前端的理念。

## 主要解决问题

更多是去解决产品体验和操作效率的问题

微前端架构能够带来独立 SPA 的体验，同时又不破坏其独立开发独立部署的研发流程。同时不同的应用统一接入到框架应用，也使得对接入的应用有了一定的管控，避免一些重复建设和不受控的技术选型

## 几种方案优缺点

1. 巨石应用：随着页面增多，开发效率与稳定性无法满足要求
2. iframe：除了用户体验问题，其实是个很不错的方案
3. 框架组件：不满足一个系统的心智，同时长期维护成本高
4. 微前端：在大型系统业务背景下，体验和效率的平衡点

## js隔离

1. iframe
2. 可以利用闭包的能力实现一个沙箱
   - 所以 ConsoleOS 实现了一个 wepback 的插件在应用代码构建的时候给子应用代码加上一层 wrap 代码，创建一个闭包，把需要隔离的浏览器原生对象变成从下面函数闭包中获取的，从而我们可以在应用加载的时候，传入模拟掉的 window，document 之类的对象。
3. 发现了一个很“取巧”的做法，我们可以 new iframe 对象，把里面的原生浏览器对象通过 contentWindow 取出来
4. 飞冰通过  Proxy 沙箱 + with + new Function的方式来实现脚本隔离

## css隔离

1. CSS Module + 添加 CSS 的 namespace
2. CSS module 保证的是应用业务样式不冲突，Namespace 保证公共库不冲突。我们实现了一个 postcss 插件，会在应用构建的时候给所有的样式都加上应用前缀包括应用公共库的 CSS。

> 原生浏览器对象的模拟（Browser-VM）的部分
> • 如何构建一个闭包环境的部分。

## 什么场景下需要微前端

1. 第一种就是大型单体应用场景，它的页面量级很大的、开发效率也因此受到影响，包括它的技术栈迁移成本也会变高。 结合微前端架构，我们可以按功能维度把它拆分成一个个独立应用。不论是增量业务还是技术架构的升级都可以低成本地在拆分开的应用中进行。
   - 项目量级变大
   - 开发效率低
   - 技术栈迁移成本高
   - 二方业务接入成本高

2. 第二种是工作台场景，更多是去解决产品体验和操作效率的问题。微前端架构能够带来独立 SPA 的体验，同时又不破坏其独立开发独立部署的研发流程。同时不同的应用统一接入到框架应用，也使得对接入的应用有了一定的管控，避免一些重复建设和不受控的技术选型。
   - 多系统独立无管控
   - 重复建设严重
   - 操作效率低
   - 体验不一直

基于上述的两个场景，微前端架构都能够给出它的答卷。